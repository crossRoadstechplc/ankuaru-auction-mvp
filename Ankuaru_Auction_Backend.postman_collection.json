{
  "info": {
    "_postman_id": "c2b86931-6f3e-4f1f-bc60-8ef73f5805b3",
    "name": "Ankuaru Auction Backend",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "description": "Postman collection for testing auth and sealed-bid auction endpoints. Set collection variables before running requests."
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:5000"
    },
    {
      "key": "token",
      "value": ""
    },
    {
      "key": "auctionId",
      "value": ""
    },
    {
      "key": "targetUserId",
      "value": ""
    },
    {
      "key": "selectedUserId",
      "value": "11111111-1111-4111-8111-111111111111"
    },
    {
      "key": "selectedUserId2",
      "value": "22222222-2222-4222-9222-222222222222"
    },
    {
      "key": "notificationId",
      "value": ""
    },
    {
      "key": "userId",
      "value": ""
    },
    {
      "key": "amount",
      "value": "1200"
    },
    {
      "key": "nonce",
      "value": "my-secret-nonce"
    },
    {
      "key": "commitHash",
      "value": ""
    },
    {
      "key": "ratingScore",
      "value": "5"
    },
    {
      "key": "reviewText",
      "value": "Great user, smooth transaction."
    }
  ],
  "item": [
    {
      "name": "Health",
      "item": [
        {
          "name": "GET /health",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/health",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "health"
              ]
            },
            "description": "Check API health status."
          },
          "response": []
        }
      ]
    },
    {
      "name": "Auth",
      "item": [
        {
          "name": "POST /api/auth/register",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"alice\",\n  \"email\": \"alice@example.com\",\n  \"password\": \"StrongPass123\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/auth/register",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "auth",
                "register"
              ]
            }
          },
          "response": []
        },
        {
          "name": "POST /api/auth/login",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status is successful', function () {",
                  "  pm.expect(pm.response.code).to.be.oneOf([200, 201]);",
                  "});",
                  "",
                  "let data = {};",
                  "try { data = pm.response.json(); } catch (e) {}",
                  "",
                  "if (data && data.token) {",
                  "  pm.collectionVariables.set('token', data.token);",
                  "}",
                  "",
                  "if (data && data.user && data.user.id) {",
                  "  pm.collectionVariables.set('userId', data.user.id);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"alice@example.com\",\n  \"password\": \"StrongPass123\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/auth/login",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "auth",
                "login"
              ]
            }
          },
          "response": []
        },
        {
          "name": "POST /api/auth/follow/:userId",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/auth/follow/{{targetUserId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "auth",
                "follow",
                "{{targetUserId}}"
              ]
            }
          },
          "response": []
        },
        {
          "name": "DELETE /api/auth/follow/:userId",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/auth/follow/{{targetUserId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "auth",
                "follow",
                "{{targetUserId}}"
              ]
            }
          },
          "response": []
        },
        {
          "name": "GET /api/auth/followers/me",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/auth/followers/me",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "auth",
                "followers",
                "me"
              ]
            }
          },
          "response": []
        },
        {
          "name": "GET /api/auth/notifications/me",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/auth/notifications/me",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "auth",
                "notifications",
                "me"
              ]
            }
          },
          "response": []
        },
        {
          "name": "PATCH /api/auth/notifications/:notificationId/read",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/auth/notifications/{{notificationId}}/read",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "auth",
                "notifications",
                "{{notificationId}}",
                "read"
              ]
            }
          },
          "response": []
        },
        {
          "name": "GET /api/auth/ratings/me/summary",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/auth/ratings/me/summary",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "auth",
                "ratings",
                "me",
                "summary"
              ]
            }
          },
          "response": []
        },
        {
          "name": "POST /api/auth/ratings/:userId",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"rating\": {{ratingScore}},\n  \"reviewText\": \"{{reviewText}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/auth/ratings/{{targetUserId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "auth",
                "ratings",
                "{{targetUserId}}"
              ]
            }
          },
          "response": []
        },
        {
          "name": "GET /api/auth/ratings/:userId",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/auth/ratings/{{targetUserId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "auth",
                "ratings",
                "{{targetUserId}}"
              ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Auctions",
      "item": [
        {
          "name": "POST /api/auctions",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "let data = {};",
                  "try { data = pm.response.json(); } catch (e) {}",
                  "",
                  "if (data && data.auction && data.auction.id) {",
                  "  pm.collectionVariables.set('auctionId', data.auction.id);",
                  "} else if (data && data.id) {",
                  "  pm.collectionVariables.set('auctionId', data.id);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Laptop Auction\",\n  \"auctionCategory\": \"Electronics\",\n  \"itemDescription\": \"MacBook Pro 16\",\n  \"reservePrice\": \"1000\",\n  \"minBid\": \"100\",\n  \"auctionType\": \"SELL\",\n  \"visibility\": \"PUBLIC\",\n  \"startAt\": \"2026-02-19T09:00:00Z\",\n  \"endAt\": \"2026-02-19T10:00:00Z\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/auctions",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "auctions"
              ]
            }
          },
          "response": []
        },
        {
          "name": "POST /api/auctions (FOLLOWERS + selectedUserIds)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Followers Only Camera Auction\",\n  \"auctionCategory\": \"Electronics\",\n  \"itemDescription\": \"Canon EOS R6\",\n  \"reservePrice\": \"900\",\n  \"minBid\": \"100\",\n  \"auctionType\": \"SELL\",\n  \"visibility\": \"FOLLOWERS\",\n  \"selectedUserIds\": [\n    \"11111111-1111-4111-8111-111111111111\",\n    \"22222222-2222-4222-9222-222222222222\"\n  ],\n  \"startAt\": \"2026-02-19T09:00:00Z\",\n  \"endAt\": \"2026-02-19T10:00:00Z\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/auctions",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "auctions"
              ]
            },
            "description": "Create an auction with FOLLOWERS visibility and include selectedUserIds in payload using sample UUIDs. Replace with real existing user IDs from your DB."
          },
          "response": []
        },
        {
          "name": "POST /api/auctions (SELECTED + selectedUserIds)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Selected Users Phone Auction\",\n  \"auctionCategory\": \"Electronics\",\n  \"itemDescription\": \"iPhone 15 Pro\",\n  \"reservePrice\": \"700\",\n  \"minBid\": \"50\",\n  \"auctionType\": \"SELL\",\n  \"visibility\": \"SELECTED\",\n  \"selectedUserIds\": [\n    \"11111111-1111-4111-8111-111111111111\",\n    \"22222222-2222-4222-9222-222222222222\"\n  ],\n  \"startAt\": \"2026-02-19T09:00:00Z\",\n  \"endAt\": \"2026-02-19T10:00:00Z\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/auctions",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "auctions"
              ]
            },
            "description": "Create an auction with SELECTED visibility and pass selectedUserIds (required for selected audience) using sample UUIDs. Replace with real existing user IDs from your DB."
          },
          "response": []
        },
        {
          "name": "GET /api/auctions",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/auctions",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "auctions"
              ]
            },
            "description": "Fetch all auctions visible to the current user. Send Authorization header to include FOLLOWERS/SELECTED auctions you can access; without token, only PUBLIC auctions are returned."
          },
          "response": []
        },
        {
          "name": "GET /api/auctions/:id",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/auctions/{{auctionId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "auctions",
                "{{auctionId}}"
              ]
            }
          },
          "response": []
        },
        {
          "name": "POST /api/auctions/:id/bids",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const auctionId = pm.collectionVariables.get('auctionId');",
                  "const userId = pm.collectionVariables.get('userId');",
                  "const amount = pm.collectionVariables.get('amount');",
                  "const nonce = pm.collectionVariables.get('nonce');",
                  "",
                  "if (auctionId && userId && amount && nonce) {",
                  "  const raw = `${auctionId}:${userId}:${amount}:${nonce}`;",
                  "  const hash = CryptoJS.SHA256(raw).toString(CryptoJS.enc.Hex);",
                  "  pm.collectionVariables.set('commitHash', hash);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"commitHash\": \"{{commitHash}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/auctions/{{auctionId}}/bids",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "auctions",
                "{{auctionId}}",
                "bids"
              ]
            }
          },
          "response": []
        },
        {
          "name": "GET /api/auctions/:id/my-bid",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/auctions/{{auctionId}}/my-bid",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "auctions",
                "{{auctionId}}",
                "my-bid"
              ]
            }
          },
          "response": []
        },
        {
          "name": "POST /api/auctions/:id/reveal",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"amount\": \"{{amount}}\",\n  \"nonce\": \"{{nonce}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/auctions/{{auctionId}}/reveal",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "auctions",
                "{{auctionId}}",
                "reveal"
              ]
            }
          },
          "response": []
        },
        {
          "name": "POST /api/auctions/:id/close",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/auctions/{{auctionId}}/close",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "auctions",
                "{{auctionId}}",
                "close"
              ]
            }
          },
          "response": []
        }
      ]
    }
  ]
}